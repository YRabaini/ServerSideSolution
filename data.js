var sqlite3 = require('sqlite3')

var db = new sqlite3.Database("./db/movie-friends.db")

//////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////// GET ALL MOVIES ////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////


exports.getAllMovies = function (callback) {
  db.all("SELECT * FROM movie", function (err, movies) {
      callback(movies)
    })
}

//////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////// GET MOVIE BY ID + ITS RATINGS ///////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////

exports.getMovieById = function (id, callback) {
  db.all("SELECT * FROM movie WHERE id = ?", id, function (err, movie) {
      db.all("select rating from rating where rating.movie_id = ?", id, function(err, rating){
            callback(movie, rating)
        })
    }
  )
}

